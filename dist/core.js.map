{"version":3,"file":"core.js","sources":["../lib/common/utils.js","../lib/common/options.js","../lib/core/module.js","../lib/core/meta.js","../lib/core/renderer.js","../lib/core/nuxt.js"],"sourcesContent":["import { resolve, relative, sep } from 'path'\nimport _ from 'lodash'\n\nexport function encodeHtml (str) {\n  return str.replace(/</g, '&lt;').replace(/>/g, '&gt;')\n}\n\nexport function getContext (req, res) {\n  return { req, res }\n}\n\nexport function setAnsiColors (ansiHTML) {\n  ansiHTML.setColors({\n    reset: ['efefef', 'a6004c'],\n    darkgrey: '5a012b',\n    yellow: 'ffab07',\n    green: 'aeefba',\n    magenta: 'ff84bf',\n    blue: '3505a0',\n    cyan: '56eaec',\n    red: '4e053a'\n  })\n}\n\nexport async function waitFor (ms) {\n  return new Promise(function (resolve) {\n    setTimeout(resolve, (ms || 0))\n  })\n}\n\nexport function urlJoin () {\n  return [].slice.call(arguments).join('/').replace(/\\/+/g, '/').replace(':/', '://')\n}\n\nexport function isUrl (url) {\n  return (url.indexOf('http') === 0 || url.indexOf('//') === 0)\n}\n\nexport function promisifyRoute (fn) {\n  // If routes is an array\n  if (Array.isArray(fn)) {\n    return Promise.resolve(fn)\n  }\n  // If routes is a function expecting a callback\n  if (fn.length === 1) {\n    return new Promise((resolve, reject) => {\n      fn(function (err, routeParams) {\n        if (err) {\n          reject(err)\n        }\n        resolve(routeParams)\n      })\n    })\n  }\n  let promise = fn()\n  if (!promise || (!(promise instanceof Promise) && (typeof promise.then !== 'function'))) {\n    promise = Promise.resolve(promise)\n  }\n  return promise\n}\n\nexport function sequence (tasks, fn) {\n  return tasks.reduce((promise, task) => promise.then(() => fn(task)), Promise.resolve())\n}\n\nexport function parallel (tasks, fn) {\n  return Promise.all(tasks.map(task => fn(task)))\n}\n\nexport function chainFn (base, fn) {\n  /* istanbul ignore if */\n  if (!(fn instanceof Function)) {\n    return\n  }\n  return function () {\n    if (typeof base !== 'function') {\n      return fn.apply(this, arguments)\n    }\n    let baseResult = base.apply(this, arguments)\n    // Allow function to mutate the first argument instead of returning the result\n    if (baseResult === undefined) {\n      baseResult = arguments[0]\n    }\n    let fnResult = fn.call(this, baseResult, ...Array.prototype.slice.call(arguments, 1))\n    // Return mutated argument if no result was returned\n    if (fnResult === undefined) {\n      return baseResult\n    }\n    return fnResult\n  }\n}\n\nexport function isPureObject (o) {\n  return !Array.isArray(o) && typeof o === 'object'\n}\n\nexport const isWindows = /^win/.test(process.platform)\n\nexport function wp (p = '') {\n  /* istanbul ignore if */\n  if (isWindows) {\n    return p.replace(/\\\\/g, '\\\\\\\\')\n  }\n  return p\n}\n\nexport function wChunk (p = '') {\n  /* istanbul ignore if */\n  if (isWindows) {\n    return p.replace(/\\//g, '\\\\\\\\')\n  }\n  return p\n}\n\nconst reqSep = /\\//g\nconst sysSep = _.escapeRegExp(sep)\nconst normalize = string => string.replace(reqSep, sysSep)\n\nexport function r () {\n  let args = Array.prototype.slice.apply(arguments)\n  let lastArg = _.last(args)\n\n  if (lastArg.includes('@') || lastArg.includes('~')) {\n    return wp(lastArg)\n  }\n\n  return wp(resolve(...args.map(normalize)))\n}\n\nexport function relativeTo () {\n  let args = Array.prototype.slice.apply(arguments)\n  let dir = args.shift()\n\n  // Resolve path\n  let path = r(...args)\n\n  // Check if path is an alias\n  if (path.includes('@') || path.includes('~')) {\n    return path\n  }\n\n  // Make correct relative path\n  let rp = relative(dir, path)\n  if (rp[0] !== '.') {\n    rp = './' + rp\n  }\n  return wp(rp)\n}\n\nexport function flatRoutes (router, path = '', routes = []) {\n  router.forEach((r) => {\n    if (!r.path.includes(':') && !r.path.includes('*')) {\n      /* istanbul ignore if */\n      if (r.children) {\n        flatRoutes(r.children, path + r.path + '/', routes)\n      } else {\n        routes.push((r.path === '' && path[path.length - 1] === '/' ? path.slice(0, -1) : path) + r.path)\n      }\n    }\n  })\n  return routes\n}\n\nexport function cleanChildrenRoutes (routes, isChild = false) {\n  let start = -1\n  let routesIndex = []\n  routes.forEach((route) => {\n    if (/-index$/.test(route.name) || route.name === 'index') {\n      // Save indexOf 'index' key in name\n      let res = route.name.split('-')\n      let s = res.indexOf('index')\n      start = (start === -1 || s < start) ? s : start\n      routesIndex.push(res)\n    }\n  })\n  routes.forEach((route) => {\n    route.path = (isChild) ? route.path.replace('/', '') : route.path\n    if (route.path.indexOf('?') > -1) {\n      let names = route.name.split('-')\n      let paths = route.path.split('/')\n      if (!isChild) {\n        paths.shift()\n      } // clean first / for parents\n      routesIndex.forEach((r) => {\n        let i = r.indexOf('index') - start //  children names\n        if (i < paths.length) {\n          for (let a = 0; a <= i; a++) {\n            if (a === i) {\n              paths[a] = paths[a].replace('?', '')\n            }\n            if (a < i && names[a] !== r[a]) {\n              break\n            }\n          }\n        }\n      })\n      route.path = (isChild ? '' : '/') + paths.join('/')\n    }\n    route.name = route.name.replace(/-index$/, '')\n    if (route.children) {\n      if (route.children.find((child) => child.path === '')) {\n        delete route.name\n      }\n      route.children = cleanChildrenRoutes(route.children, true)\n    }\n  })\n  return routes\n}\n\nexport function createRoutes (files, srcDir) {\n  let routes = []\n  files.forEach((file) => {\n    let keys = file.replace(/^pages/, '').replace(/\\.vue$/, '').replace(/\\/{2,}/g, '/').split('/').slice(1)\n    let route = { name: '', path: '', component: r(srcDir, file) }\n    let parent = routes\n    keys.forEach((key, i) => {\n      route.name = route.name ? route.name + '-' + key.replace('_', '') : key.replace('_', '')\n      route.name += (key === '_') ? 'all' : ''\n      route.chunkName = file.replace(/\\.vue$/, '')\n      let child = _.find(parent, { name: route.name })\n      if (child) {\n        child.children = child.children || []\n        parent = child.children\n        route.path = ''\n      } else {\n        if (key === 'index' && (i + 1) === keys.length) {\n          route.path += (i > 0 ? '' : '/')\n        } else {\n          route.path += '/' + (key === '_' ? '*' : key.replace('_', ':'))\n          if (key !== '_' && key.indexOf('_') !== -1) {\n            route.path += '?'\n          }\n        }\n      }\n    })\n    // Order Routes path\n    parent.push(route)\n    parent.sort((a, b) => {\n      if (!a.path.length || a.path === '/') {\n        return -1\n      }\n      if (!b.path.length || b.path === '/') {\n        return 1\n      }\n      let i = 0\n      let res = 0\n      let y = 0\n      let z = 0\n      const _a = a.path.split('/')\n      const _b = b.path.split('/')\n      for (i = 0; i < _a.length; i++) {\n        if (res !== 0) {\n          break\n        }\n        y = _a[i] === '*' ? 2 : (_a[i].indexOf(':') > -1 ? 1 : 0)\n        z = _b[i] === '*' ? 2 : (_b[i].indexOf(':') > -1 ? 1 : 0)\n        res = y - z\n        // If a.length >= b.length\n        if (i === _b.length - 1 && res === 0) {\n          // change order if * found\n          res = _a[i] === '*' ? -1 : 1\n        }\n      }\n      return res === 0 ? (_a[i - 1] === '*' && _b[i] ? 1 : -1) : res\n    })\n  })\n  return cleanChildrenRoutes(routes)\n}\n","import _ from 'lodash'\nimport { join, resolve } from 'path'\nimport { existsSync } from 'fs'\nimport { isUrl, isPureObject } from 'utils'\n\nconst Options = {}\n\nexport default Options\n\nOptions.from = function (_options) {\n  // Clone options to prevent unwanted side-effects\n  const options = Object.assign({}, _options)\n\n  // Normalize options\n  if (options.loading === true) {\n    delete options.loading\n  }\n  if (options.router && typeof options.router.middleware === 'string') {\n    options.router.middleware = [options.router.middleware]\n  }\n  if (options.router && typeof options.router.base === 'string') {\n    options._routerBaseSpecified = true\n  }\n  if (typeof options.transition === 'string') {\n    options.transition = { name: options.transition }\n  }\n  if (typeof options.layoutTransition === 'string') {\n    options.layoutTransition = { name: options.layoutTransition }\n  }\n\n  // Apply defaults\n  _.defaultsDeep(options, Options.defaults)\n\n  // Resolve dirs\n  const hasValue = v => typeof v === 'string' && v\n  options.rootDir = hasValue(options.rootDir) ? options.rootDir : process.cwd()\n  options.srcDir = hasValue(options.srcDir) ? resolve(options.rootDir, options.srcDir) : options.rootDir\n  options.modulesDir = resolve(options.rootDir, hasValue(options.modulesDir) ? options.modulesDir : 'node_modules')\n  options.buildDir = resolve(options.rootDir, options.buildDir)\n  options.cacheDir = resolve(options.rootDir, options.cacheDir)\n\n  // If app.html is defined, set the template path to the user template\n  options.appTemplatePath = resolve(options.buildDir, 'views/app.template.html')\n  if (existsSync(join(options.srcDir, 'app.html'))) {\n    options.appTemplatePath = join(options.srcDir, 'app.html')\n  }\n\n  // Ignore publicPath on dev\n  /* istanbul ignore if */\n  if (options.dev && isUrl(options.build.publicPath)) {\n    options.build.publicPath = Options.defaults.build.publicPath\n  }\n\n  // If store defined, update store options to true unless explicitly disabled\n  if (options.store !== false && existsSync(join(options.srcDir, 'store'))) {\n    options.store = true\n  }\n\n  // Normalize loadingIndicator\n  if (!isPureObject(options.loadingIndicator)) {\n    options.loadingIndicator = { name: options.loadingIndicator }\n  }\n\n  // Apply defaults to loadingIndicator\n  options.loadingIndicator = Object.assign({\n    name: 'pulse',\n    color: '#dbe1ec',\n    background: 'white'\n  }, options.loadingIndicator)\n\n  // cssSourceMap\n  if (options.build.cssSourceMap === undefined) {\n    options.build.cssSourceMap = options.dev\n  }\n\n  // Postcss\n  // 1. Check if it is explicitly disabled by false value\n  // ... Disable all postcss loaders\n  // 2. Check if any standard source of postcss config exists\n  // ... Make postcss = true letting loaders find this kind of config\n  // 3. Else (Easy Usage)\n  // ... Auto merge it with defaults\n  if (options.build.postcss !== false) {\n    // Detect postcss config existence\n    // https://github.com/michael-ciniawsky/postcss-load-config\n    let postcssConfigExists = false\n    for (let dir of [options.srcDir, options.rootDir]) {\n      for (let file of ['postcss.config.js', '.postcssrc.js', '.postcssrc', '.postcssrc.json', '.postcssrc.yaml']) {\n        if (existsSync(resolve(dir, file))) {\n          postcssConfigExists = true\n          break\n        }\n      }\n      if (postcssConfigExists) break\n    }\n\n    // Default postcss options\n    if (postcssConfigExists) {\n      options.build.postcss = true\n    }\n\n    // Normalize & Apply default plugins\n    if (Array.isArray(options.build.postcss)) {\n      options.build.postcss = { plugins: options.build.postcss }\n    }\n    if (isPureObject(options.build.postcss)) {\n      options.build.postcss = Object.assign({\n        sourceMap: options.build.cssSourceMap,\n        plugins: {\n          // https://github.com/postcss/postcss-import\n          'postcss-import': {\n            root: options.rootDir,\n            path: [\n              options.srcDir,\n              options.rootDir,\n              options.modulesDir\n            ]\n          },\n          // https://github.com/postcss/postcss-url\n          'postcss-url': {},\n          // http://cssnext.io/postcss\n          'postcss-cssnext': {}\n        }\n      }, options.build.postcss)\n    }\n  }\n\n  // Debug errors\n  if (options.debug === undefined) {\n    options.debug = options.dev\n  }\n\n  // Apply mode preset\n  let modePreset = Options.modes[options.mode || 'universal'] || Options.modes['universal']\n  _.defaultsDeep(options, modePreset)\n\n  // If no server-side rendering, add appear true transition\n  if (options.render.ssr === false) {\n    options.transition.appear = true\n  }\n\n  return options\n}\n\nOptions.modes = {\n  universal: {\n    build: {\n      ssr: true\n    },\n    render: {\n      ssr: true\n    }\n  },\n  spa: {\n    build: {\n      ssr: false\n    },\n    render: {\n      ssr: false\n    }\n  }\n}\n\nOptions.defaults = {\n  mode: 'universal',\n  dev: process.env.NODE_ENV !== 'production',\n  debug: undefined, // Will be equal to dev if not provided\n  buildDir: '.nuxt',\n  cacheDir: '.cache',\n  nuxtAppDir: resolve(__dirname, '../lib/app/'), // Relative to dist\n  build: {\n    analyze: false,\n    dll: false,\n    extractCSS: false,\n    cssSourceMap: undefined,\n    ssr: undefined,\n    publicPath: '/_nuxt/',\n    filenames: {\n      css: 'common.[contenthash].css',\n      manifest: 'manifest.[hash].js',\n      vendor: 'common.[chunkhash].js',\n      app: 'app.[chunkhash].js',\n      chunk: '[name].[chunkhash].js'\n    },\n    vendor: [],\n    plugins: [],\n    babel: {},\n    postcss: {},\n    templates: [],\n    watch: [],\n    devMiddleware: {},\n    hotMiddleware: {}\n  },\n  generate: {\n    dir: 'dist',\n    routes: [],\n    concurrency: 500,\n    interval: 0,\n    minify: {\n      collapseBooleanAttributes: true,\n      collapseWhitespace: true,\n      decodeEntities: true,\n      minifyCSS: true,\n      minifyJS: true,\n      processConditionalComments: true,\n      removeAttributeQuotes: false,\n      removeComments: false,\n      removeEmptyAttributes: true,\n      removeOptionalTags: true,\n      removeRedundantAttributes: true,\n      removeScriptTypeAttributes: false,\n      removeStyleLinkTypeAttributes: false,\n      removeTagWhitespace: false,\n      sortAttributes: true,\n      sortClassName: false,\n      trimCustomFragments: true,\n      useShortDoctype: true\n    }\n  },\n  env: {},\n  head: {\n    meta: [],\n    link: [],\n    style: [],\n    script: []\n  },\n  plugins: [],\n  css: [],\n  modules: [],\n  layouts: {},\n  serverMiddleware: [],\n  ErrorPage: null,\n  loading: {\n    color: 'black',\n    failedColor: 'red',\n    height: '2px',\n    duration: 5000,\n    rtl: false\n  },\n  loadingIndicator: {},\n  transition: {\n    name: 'page',\n    mode: 'out-in',\n    appear: false,\n    appearClass: 'appear',\n    appearActiveClass: 'appear-active',\n    appearToClass: 'appear-to'\n  },\n  layoutTransition: {\n    name: 'layout',\n    mode: 'out-in'\n  },\n  router: {\n    mode: 'history',\n    base: '/',\n    routes: [],\n    middleware: [],\n    linkActiveClass: 'nuxt-link-active',\n    linkExactActiveClass: 'nuxt-link-exact-active',\n    extendRoutes: null,\n    scrollBehavior: null,\n    fallback: false\n  },\n  render: {\n    bundleRenderer: {},\n    resourceHints: true,\n    ssr: undefined,\n    http2: {\n      push: false\n    },\n    static: {},\n    gzip: {\n      threshold: 0\n    },\n    etag: {\n      weak: true // Faster for responses > 5KB\n    }\n  },\n  watchers: {\n    webpack: {\n      ignored: /-dll/\n    },\n    chokidar: {}\n  },\n  editor: {\n    editor: 'code'\n  },\n  messages: {\n    error_404: 'This page could not be found',\n    server_error: 'Server error',\n    nuxtjs: 'Nuxt.js',\n    back_to_home: 'Back to the home page',\n    server_error_details: 'An error occurred in the application and your page could not be served. If you are the application owner, check your logs for details.',\n    client_error: 'Error',\n    client_error_details: 'An error occurred while rendering the page. Check developer tools console for details.'\n  }\n}\n","import path from 'path'\nimport fs from 'fs'\nimport { uniq } from 'lodash'\nimport hash from 'hash-sum'\nimport Tapable from 'tappable'\nimport { chainFn, sequence } from 'utils'\nimport Debug from 'debug'\n\nconst debug = Debug('nuxt:module')\n\nexport default class ModuleContainer extends Tapable {\n  constructor (nuxt) {\n    super()\n    this.nuxt = nuxt\n    this.options = nuxt.options\n    this.requiredModules = []\n  }\n\n  async _ready () {\n    await sequence(this.options.modules, this.addModule.bind(this))\n    await this.applyPluginsAsync('ready', this)\n  }\n\n  addVendor (vendor) {\n    /* istanbul ignore if */\n    if (!vendor) {\n      return\n    }\n    this.options.build.vendor = uniq(this.options.build.vendor.concat(vendor))\n  }\n\n  addTemplate (template) {\n    /* istanbul ignore if */\n    if (!template) {\n      return\n    }\n    // Validate & parse source\n    const src = template.src || template\n    const srcPath = path.parse(src)\n    /* istanbul ignore if */\n    if (!src || typeof src !== 'string' || !fs.existsSync(src)) {\n      /* istanbul ignore next */\n      debug('[nuxt] invalid template', template)\n      return\n    }\n    // Generate unique and human readable dst filename\n    const dst = template.fileName ||\n      (path.basename(srcPath.dir) + '.' + srcPath.name + '.' + hash(src) + srcPath.ext)\n    // Add to templates list\n    const templateObj = {\n      src,\n      dst,\n      options: template.options\n    }\n    this.options.build.templates.push(templateObj)\n    return templateObj\n  }\n\n  addPlugin (template) {\n    const { dst } = this.addTemplate(template)\n    // Add to nuxt plugins\n    this.options.plugins.unshift({\n      src: path.join(this.options.buildDir, dst),\n      ssr: template.ssr\n    })\n  }\n\n  addServerMiddleware (middleware) {\n    this.options.serverMiddleware.push(middleware)\n  }\n\n  extendBuild (fn) {\n    this.options.build.extend = chainFn(this.options.build.extend, fn)\n  }\n\n  extendRoutes (fn) {\n    this.options.router.extendRoutes = chainFn(this.options.router.extendRoutes, fn)\n  }\n\n  requireModule (moduleOpts) {\n    // Require once\n    return this.addModule(moduleOpts, true)\n  }\n\n  async addModule (moduleOpts, requireOnce) {\n    /* istanbul ignore if */\n    if (!moduleOpts) {\n      return\n    }\n\n    await this.applyPluginsAsync('add', {moduleOpts, requireOnce})\n\n    // Allow using babel style array options\n    if (Array.isArray(moduleOpts)) {\n      moduleOpts = {\n        src: moduleOpts[0],\n        options: moduleOpts[1]\n      }\n    }\n\n    // Allows passing runtime options to each module\n    const options = moduleOpts.options || (typeof moduleOpts === 'object' ? moduleOpts : {})\n    const originalSrc = moduleOpts.src || moduleOpts\n\n    // Resolve module\n    let module = originalSrc\n    if (typeof module === 'string') {\n      module = require(this.nuxt.resolvePath(module))\n    }\n\n    // Validate module\n    /* istanbul ignore if */\n    if (typeof module !== 'function') {\n      throw new Error(`[nuxt] Module ${JSON.stringify(originalSrc)} should export a function`)\n    }\n\n    // Module meta\n    if (!module.meta) {\n      module.meta = {}\n    }\n    if (module.meta.name) {\n      const alreadyRequired = this.requiredModules.indexOf(module.meta.name) !== -1\n      if (requireOnce && alreadyRequired) {\n        return\n      }\n      if (!alreadyRequired) {\n        this.requiredModules.push(module.meta.name)\n      }\n    }\n\n    // Call module with `this` context and pass options\n    return new Promise((resolve, reject) => {\n      const result = module.call(this, options, err => {\n        /* istanbul ignore if */\n        if (err) {\n          return reject(err)\n        }\n        resolve(module)\n      })\n      // If module send back a promise\n      if (result && result.then instanceof Function) {\n        return result.then(resolve)\n      }\n      // If not expecting a callback but returns no promise (=synchronous)\n      if (module.length < 2) {\n        return resolve(module)\n      }\n    })\n  }\n}\n","\nimport Vue from 'vue'\nimport VueMeta from 'vue-meta'\nimport VueServerRenderer from 'vue-server-renderer'\nimport LRU from 'lru-cache'\n\nexport default class MetaRenderer {\n  constructor (nuxt, renderer) {\n    this.nuxt = nuxt\n    this.renderer = renderer\n    this.options = nuxt.options\n    this.vueRenderer = VueServerRenderer.createRenderer()\n    this.cache = LRU({})\n\n    // Add VueMeta to Vue (this is only for SPA mode)\n    // See lib/app/index.js\n    Vue.use(VueMeta, {\n      keyName: 'head',\n      attribute: 'data-n-head',\n      ssrAttribute: 'data-n-head-ssr',\n      tagIDKeyName: 'hid'\n    })\n  }\n\n  getMeta (url) {\n    return new Promise((resolve, reject) => {\n      const vm = new Vue({\n        render: (h) => h(), // Render empty html tag\n        head: this.options.head || {}\n      })\n      this.vueRenderer.renderToString(vm, (err) => {\n        if (err) return reject(err)\n        resolve(vm.$meta().inject())\n      })\n    })\n  }\n\n  async render ({ url = '/' }) {\n    let meta = this.cache.get(url)\n\n    if (meta) {\n      return meta\n    }\n\n    meta = {\n      HTML_ATTRS: '',\n      BODY_ATTRS: '',\n      HEAD: ''\n    }\n    // Get vue-meta context\n    const m = await this.getMeta(url)\n    // HTML_ATTRS\n    meta.HTML_ATTRS = m.htmlAttrs.text()\n    // BODY_ATTRS\n    meta.BODY_ATTRS = m.bodyAttrs.text()\n    // HEAD tags\n    meta.HEAD = m.meta.text() + m.title.text() + m.link.text() + m.style.text() + m.script.text() + m.noscript.text()\n    // Resources Hints\n    meta.resourceHints = ''\n    // Resource Hints\n    const clientManifest = this.renderer.resources.clientManifest\n    if (this.options.render.resourceHints && clientManifest) {\n      const publicPath = clientManifest.publicPath || '/_nuxt/'\n      // Pre-Load initial resources\n      if (Array.isArray(clientManifest.initial)) {\n        meta.resourceHints += clientManifest.initial.map(r => `<link rel=\"preload\" href=\"${publicPath}${r}\" as=\"script\" />`).join('')\n      }\n      // Pre-Fetch async resources\n      if (Array.isArray(clientManifest.async)) {\n        meta.resourceHints += clientManifest.async.map(r => `<link rel=\"prefetch\" href=\"${publicPath}${r}\" />`).join('')\n      }\n      // Add them to HEAD\n      if (meta.resourceHints) {\n        meta.HEAD += meta.resourceHints\n      }\n    }\n\n    // Set meta tags inside cache\n    this.cache.set(url, meta)\n\n    return meta\n  }\n}\n","import ansiHTML from 'ansi-html'\nimport serialize from 'serialize-javascript'\nimport generateETag from 'etag'\nimport fresh from 'fresh'\nimport Tapable from 'tappable'\nimport pify from 'pify'\nimport serveStatic from 'serve-static'\nimport compression from 'compression'\nimport _ from 'lodash'\nimport { join, resolve } from 'path'\nimport fs from 'fs-extra'\nimport { createBundleRenderer } from 'vue-server-renderer'\nimport { getContext, setAnsiColors, isUrl } from 'utils'\nimport Debug from 'debug'\nimport Youch from '@nuxtjs/youch'\nimport { SourceMapConsumer } from 'source-map'\nimport connect from 'connect'\nimport { Options } from 'common'\nimport MetaRenderer from './meta'\n\nconst debug = Debug('nuxt:render')\ndebug.color = 4 // Force blue color\n\nsetAnsiColors(ansiHTML)\n\nlet jsdom = null\n\nexport default class Renderer extends Tapable {\n  constructor (nuxt) {\n    super()\n    this.nuxt = nuxt\n    this.options = nuxt.options\n\n    // Will be set by createRenderer\n    this.bundleRenderer = null\n    this.metaRenderer = null\n\n    // Will be available on dev\n    this.webpackDevMiddleware = null\n    this.webpackHotMiddleware = null\n\n    // Create new connect instance\n    this.app = connect()\n\n    // Renderer runtime resources\n    this.resources = {\n      clientManifest: null,\n      serverBundle: null,\n      ssrTemplate: null,\n      spaTemplate: null,\n      errorTemplate: parseTemplate('Nuxt.js Internal Server Error')\n    }\n  }\n\n  async _ready () {\n    await this.nuxt.applyPluginsAsync('renderer', this)\n\n    // Setup nuxt middleware\n    await this.setupMiddleware()\n\n    // Load SSR resources from fs\n    if (!this.options.dev) {\n      await this.loadResources()\n    }\n\n    // Call ready plugin\n    await this.applyPluginsAsync('ready', this)\n  }\n\n  async loadResources (_fs = fs) {\n    let distPath = resolve(this.options.buildDir, 'dist')\n    let updated = []\n\n    resourceMap.forEach(({ key, fileName, transform }) => {\n      let rawKey = '$$' + key\n      const path = join(distPath, fileName)\n\n      let rawData, data\n      if (!_fs.existsSync(path)) {\n        return // Resource not exists\n      }\n      rawData = _fs.readFileSync(path, 'utf8')\n      if (!rawData || rawData === this.resources[rawKey]) {\n        return // No changes\n      }\n      this.resources[rawKey] = rawData\n      data = transform(rawData)\n      /* istanbul ignore if */\n      if (!data) {\n        return // Invalid data ?\n      }\n      this.resources[key] = data\n      updated.push(key)\n    })\n\n    // Reload error template\n    const errorTemplatePath = resolve(this.options.buildDir, 'views/error.html')\n    if (fs.existsSync(errorTemplatePath)) {\n      this.resources.errorTemplate = parseTemplate(fs.readFileSync(errorTemplatePath, 'utf8'))\n    }\n\n    // Load loading template\n    const loadingHTMLPath = resolve(this.options.buildDir, 'loading.html')\n    if (fs.existsSync(loadingHTMLPath)) {\n      this.resources.loadingHTML = fs.readFileSync(loadingHTMLPath, 'utf8')\n      this.resources.loadingHTML = this.resources.loadingHTML.replace(/[\\r|\\n]/g, '')\n    } else {\n      this.resources.loadingHTML = ''\n    }\n\n    // Call resourcesLoaded plugin\n    await this.applyPluginsAsync('resourcesLoaded', this.resources)\n\n    if (updated.length > 0) {\n      // debug('Updated', updated.join(', '), isServer)\n      this.createRenderer()\n    }\n  }\n\n  get noSSR () {\n    return this.options.render.ssr === false\n  }\n\n  get isReady () {\n    if (this.noSSR) {\n      return Boolean(this.resources.spaTemplate)\n    }\n\n    return Boolean(this.bundleRenderer && this.resources.ssrTemplate)\n  }\n\n  get isResourcesAvailable () {\n    // Required for both\n    if (!this.resources.clientManifest) {\n      return false\n    }\n\n    // Required for SPA rendering\n    if (this.noSSR) {\n      return Boolean(this.resources.spaTemplate)\n    }\n\n    // Required for bundle renderer\n    return Boolean(this.resources.ssrTemplate && this.resources.serverBundle)\n  }\n\n  createRenderer () {\n    // Ensure resources are available\n    if (!this.isResourcesAvailable) {\n      return\n    }\n\n    // Create Meta Renderer\n    this.metaRenderer = new MetaRenderer(this.nuxt, this)\n\n    // Show Open URL\n    this.nuxt.showOpen()\n\n    // Skip following steps if noSSR mode\n    if (this.noSSR) {\n      return\n    }\n\n    // Create bundle renderer for SSR\n    this.bundleRenderer = createBundleRenderer(this.resources.serverBundle, Object.assign({\n      clientManifest: this.resources.clientManifest,\n      runInNewContext: false,\n      basedir: this.options.rootDir\n    }, this.options.render.bundleRenderer))\n\n    // Promisify renderToString\n    this.bundleRenderer.renderToString = pify(this.bundleRenderer.renderToString)\n  }\n\n  useMiddleware (m) {\n    // Resolve\n    const $m = m\n    let src\n    if (typeof m === 'string') {\n      src = this.nuxt.resolvePath(m)\n      m = require(src)\n    }\n    if (typeof m.handler === 'string') {\n      src = this.nuxt.resolvePath(m.handler)\n      m.handler = require(src)\n    }\n\n    const handler = m.handler || m\n    const path = (((m.prefix !== false) ? this.options.router.base : '') + (m.path ? m.path : '')).replace(/\\/\\//g, '/')\n\n    // Inject $src and $m to final handler\n    if (src) handler.$src = src\n    handler.$m = $m\n\n    // Use middleware\n    this.app.use(path, handler)\n  }\n\n  get publicPath () {\n    return isUrl(this.options.build.publicPath) ? Options.defaults.build.publicPath : this.options.build.publicPath\n  }\n\n  async setupMiddleware () {\n    // Apply setupMiddleware from modules first\n    await this.applyPluginsAsync('setupMiddleware', this.app)\n\n    // Gzip middleware for production\n    if (!this.options.dev && this.options.render.gzip) {\n      this.useMiddleware(compression(this.options.render.gzip))\n    }\n\n    // Common URL checks\n    this.useMiddleware((req, res, next) => {\n      // Prevent access to SSR resources\n      if (ssrResourceRegex.test(req.url)) {\n        res.statusCode = 404\n        return res.end()\n      }\n      next()\n    })\n\n    // Add webpack middleware only for development\n    if (this.options.dev) {\n      this.useMiddleware(async (req, res, next) => {\n        if (this.webpackDevMiddleware) {\n          await this.webpackDevMiddleware(req, res)\n        }\n        if (this.webpackHotMiddleware) {\n          await this.webpackHotMiddleware(req, res)\n        }\n        next()\n      })\n    }\n\n    // open in editor for debug mode only\n    const _this = this\n    if (this.options.debug) {\n      this.useMiddleware({\n        path: '_open',\n        handler (req, res) {\n          // Lazy load open-in-editor\n          const openInEditor = require('open-in-editor')\n          const editor = openInEditor.configure(_this.options.editor)\n          // Parse Query\n          const query = req.url.split('?')[1].split('&').reduce((q, part) => {\n            const s = part.split('=')\n            q[s[0]] = decodeURIComponent(s[1])\n            return q\n          }, {})\n          // eslint-disable-next-line no-console\n          console.log('[open in editor]', query.file)\n          editor.open(query.file).then(() => {\n            res.end('opened in editor!')\n          }).catch(err => {\n            res.end(err)\n          })\n        }\n      })\n    }\n\n    // For serving static/ files to /\n    this.useMiddleware(serveStatic(resolve(this.options.srcDir, 'static'), this.options.render.static))\n\n    // Serve .nuxt/dist/ files only for production\n    // For dev they will be served with devMiddleware\n    if (!this.options.dev) {\n      const distDir = resolve(this.options.buildDir, 'dist')\n      this.useMiddleware({\n        path: this.publicPath,\n        handler: serveStatic(distDir, {\n          index: false, // Don't serve index.html template\n          maxAge: '1y' // 1 year in production\n        })\n      })\n    }\n\n    // Add User provided middleware\n    this.options.serverMiddleware.forEach(m => {\n      this.useMiddleware(m)\n    })\n\n    // Finally use nuxtMiddleware\n    this.useMiddleware(this.nuxtMiddleware.bind(this))\n\n    // Error middleware for errors that occurred in middleware that declared above\n    // Middleware should exactly take 4 arguments\n    // https://github.com/senchalabs/connect#error-middleware\n    this.useMiddleware(this.errorMiddleware.bind(this))\n  }\n\n  async nuxtMiddleware (req, res, next) {\n    // Get context\n    const context = getContext(req, res)\n    res.statusCode = 200\n    try {\n      const { html, error, redirected, resourceHints } = await this.renderRoute(req.url, context)\n      if (redirected) {\n        return html\n      }\n      if (error) {\n        res.statusCode = context.nuxt.error.statusCode || 500\n      }\n\n      // Add ETag header\n      if (!error && this.options.render.etag) {\n        const etag = generateETag(html, this.options.render.etag)\n        if (fresh(req.headers, { etag })) {\n          res.statusCode = 304\n          res.end()\n          return\n        }\n        res.setHeader('ETag', etag)\n      }\n\n      // HTTP2 push headers\n      if (!error && this.options.render.http2.push) {\n        // Parse resourceHints to extract HTTP.2 prefetch/push headers\n        // https://w3c.github.io/preload/#server-push-http-2\n        const regex = /link rel=\"([^\"]*)\" href=\"([^\"]*)\" as=\"([^\"]*)\"/g\n        const pushAssets = []\n        let m\n        while (m = regex.exec(resourceHints)) { // eslint-disable-line no-cond-assign\n          const [_, rel, href, as] = m // eslint-disable-line no-unused-vars\n          if (rel === 'preload') {\n            pushAssets.push(`<${href}>; rel=${rel}; as=${as}`)\n          }\n        }\n        // Pass with single Link header\n        // https://blog.cloudflare.com/http-2-server-push-with-multiple-assets-per-link-header\n        res.setHeader('Link', pushAssets.join(','))\n      }\n\n      // Send response\n      res.setHeader('Content-Type', 'text/html; charset=utf-8')\n      res.setHeader('Content-Length', Buffer.byteLength(html))\n      res.end(html, 'utf8')\n      return html\n    } catch (err) {\n      /* istanbul ignore if */\n      if (context && context.redirected) {\n        console.error(err) // eslint-disable-line no-console\n        return err\n      }\n\n      next(err)\n    }\n  }\n\n  errorMiddleware (err, req, res, next) {\n    // ensure statusCode, message and name fields\n    err.statusCode = err.statusCode || 500\n    err.message = err.message || 'Nuxt Server Error'\n    err.name = (!err.name || err.name === 'Error') ? 'NuxtServerError' : err.name\n\n    // We hide actual errors from end users, so show them on server logs\n    if (err.statusCode !== 404) {\n      console.error(err) // eslint-disable-line no-console\n    }\n\n    const sendResponse = (content, type = 'text/html') => {\n      // Set Headers\n      res.statusCode = err.statusCode\n      res.statusMessage = err.name\n      res.setHeader('Content-Type', type + '; charset=utf-8')\n      res.setHeader('Content-Length', Buffer.byteLength(content))\n\n      // Send Response\n      res.end(content, 'utf-8')\n    }\n\n    // Check if request accepts JSON\n    const hasReqHeader = (header, includes) => req.headers[header] && req.headers[header].toLowerCase().includes(includes)\n    const isJson = hasReqHeader('accept', 'application/json') || hasReqHeader('user-agent', 'curl/')\n\n    // Use basic errors when debug mode is disabled\n    if (!this.options.debug) {\n      // Json format is compatible with Youch json responses\n      const json = {\n        status: err.statusCode,\n        message: err.message,\n        name: err.name\n      }\n      if (isJson) {\n        sendResponse(JSON.stringify(json, undefined, 2), 'text/json')\n        return\n      }\n      const html = this.resources.errorTemplate(json)\n      sendResponse(html)\n      return\n    }\n\n    // Show stack trace\n    const youch = new Youch(err, req, this.readSource.bind(this))\n    if (isJson) {\n      youch.toJSON().then(json => { sendResponse(JSON.stringify(json, undefined, 2), 'text/json') })\n    } else {\n      youch.toHTML().then(html => { sendResponse(html) })\n    }\n  }\n\n  async readSource (frame) {\n    const serverBundle = this.resources.serverBundle\n\n    // Remove webpack:/// & query string from the end\n    const sanitizeName = name => name ? name.replace('webpack:///', '').split('?')[0] : ''\n\n    // SourceMap Support for SSR Bundle\n    if (serverBundle && serverBundle.maps[frame.fileName]) {\n      // Initialize smc cache\n      if (!serverBundle.$maps) {\n        serverBundle.$maps = {}\n      }\n\n      // Read SourceMap object\n      const smc = serverBundle.$maps[frame.fileName] || new SourceMapConsumer(serverBundle.maps[frame.fileName])\n      serverBundle.$maps[frame.fileName] = smc\n\n      // Try to find original position\n      const { line, column, name, source } = smc.originalPositionFor({\n        line: frame.getLineNumber() || 0,\n        column: frame.getColumnNumber() || 0\n      })\n      if (line) {\n        frame.lineNumber = line\n      }\n      if (column) {\n        frame.columnNumber = column\n      }\n      if (name) {\n        frame.functionName = name\n      }\n      if (source) {\n        frame.fileName = sanitizeName(source)\n\n        // Source detected, try to get original source code\n        const contents = smc.sourceContentFor(source)\n        if (contents) {\n          frame.contents = contents\n        }\n      }\n    }\n\n    // Return if fileName is still unknown\n    if (!frame.fileName) {\n      return\n    }\n\n    frame.fileName = sanitizeName(frame.fileName)\n\n    // Try to read from SSR bundle files\n    if (serverBundle && serverBundle.files[frame.fileName]) {\n      frame.contents = serverBundle.files[frame.fileName]\n      return\n    }\n\n    // Possible paths for file\n    const searchPath = [\n      this.options.rootDir,\n      join(this.options.buildDir, 'dist'),\n      this.options.srcDir,\n      this.options.buildDir\n    ]\n\n    // Scan filesystem for real path\n    for (let pathDir of searchPath) {\n      let fullPath = resolve(pathDir, frame.fileName)\n      let source = await fs.readFile(fullPath, 'utf-8').catch(() => null)\n      if (source) {\n        if (!frame.contents) {\n          frame.contents = source\n        }\n        frame.fullPath = fullPath\n        return\n      }\n    }\n  }\n\n  async renderRoute (url, context = {}) {\n    /* istanbul ignore if */\n    if (!this.isReady) {\n      return new Promise(resolve => {\n        setTimeout(() => resolve(this.renderRoute(url, context)), 1000)\n      })\n    }\n\n    // Log rendered url\n    debug(`Rendering url ${url}`)\n\n    // Add url and isSever to the context\n    context.url = url\n    context.isServer = true\n\n    // Basic response if SSR is disabled or spa data provided\n    const spa = context.spa || (context.res && context.res.spa)\n    if (this.noSSR || spa) {\n      const { HTML_ATTRS, BODY_ATTRS, HEAD, resourceHints } = await this.metaRenderer.render(context)\n      const APP = `<div id=\"__nuxt\">${this.resources.loadingHTML}</div>`\n\n      // Detect 404 errors\n      if (url.includes(this.options.build.publicPath) || url.includes('__webpack')) {\n        const err = { statusCode: 404, message: this.options.messages.error_404, name: 'ResourceNotFound' }\n        throw err\n      }\n\n      const data = {\n        HTML_ATTRS,\n        BODY_ATTRS,\n        HEAD,\n        APP\n      }\n\n      const html = this.resources.spaTemplate(data)\n\n      return { html, resourceHints }\n    }\n\n    // Call renderToString from the bundleRenderer and generate the HTML (will update the context as well)\n    let APP = await this.bundleRenderer.renderToString(context)\n\n    if (!context.nuxt.serverRendered) {\n      APP = '<div id=\"__nuxt\"></div>'\n    }\n    const m = context.meta.inject()\n    let HEAD = m.meta.text() + m.title.text() + m.link.text() + m.style.text() + m.script.text() + m.noscript.text()\n    if (this.options._routerBaseSpecified) {\n      HEAD += `<base href=\"${this.options.router.base}\">`\n    }\n\n    let resourceHints = ''\n\n    if (this.options.render.resourceHints) {\n      resourceHints = context.renderResourceHints()\n      HEAD += resourceHints\n    }\n    APP += `<script type=\"text/javascript\">window.__NUXT__=${serialize(context.nuxt, { isJSON: true })};</script>`\n    APP += context.renderScripts()\n\n    HEAD += context.renderStyles()\n\n    let html = this.resources.ssrTemplate({\n      HTML_ATTRS: 'data-n-head-ssr ' + m.htmlAttrs.text(),\n      BODY_ATTRS: m.bodyAttrs.text(),\n      HEAD,\n      APP\n    })\n\n    return {\n      html,\n      resourceHints,\n      error: context.nuxt.error,\n      redirected: context.redirected\n    }\n  }\n\n  async renderAndGetWindow (url, opts = {}) {\n    /* istanbul ignore if */\n    if (!jsdom) {\n      try {\n        jsdom = require('jsdom')\n      } catch (e) /* istanbul ignore next */ {\n        console.error('Fail when calling nuxt.renderAndGetWindow(url)') // eslint-disable-line no-console\n        console.error('jsdom module is not installed') // eslint-disable-line no-console\n        console.error('Please install jsdom with: npm install --save-dev jsdom') // eslint-disable-line no-console\n        throw e\n      }\n    }\n    let options = {\n      resources: 'usable', // load subresources (https://github.com/tmpvar/jsdom#loading-subresources)\n      runScripts: 'dangerously',\n      beforeParse (window) {\n        // Mock window.scrollTo\n        window.scrollTo = () => {\n        }\n      }\n    }\n    if (opts.virtualConsole !== false) {\n      options.virtualConsole = new jsdom.VirtualConsole().sendTo(console)\n    }\n    url = url || 'http://localhost:3000'\n    const { window } = await jsdom.JSDOM.fromURL(url, options)\n    // If Nuxt could not be loaded (error from the server-side)\n    const nuxtExists = window.document.body.innerHTML.includes(this.options.render.ssr ? 'window.__NUXT__' : '<div id=\"__nuxt\">')\n    /* istanbul ignore if */\n    if (!nuxtExists) {\n      let error = new Error('Could not load the nuxt app')\n      error.body = window.document.body.innerHTML\n      throw error\n    }\n    // Used by nuxt.js to say when the components are loaded and the app ready\n    await new Promise((resolve) => {\n      window._onNuxtLoaded = () => resolve(window)\n    })\n    // Send back window object\n    return window\n  }\n}\n\nconst parseTemplate = templateStr => _.template(templateStr, {\n  interpolate: /{{([\\s\\S]+?)}}/g\n})\n\nconst resourceMap = [\n  {\n    key: 'clientManifest',\n    fileName: 'vue-ssr-client-manifest.json',\n    transform: JSON.parse\n  },\n  {\n    key: 'serverBundle',\n    fileName: 'server-bundle.json',\n    transform: JSON.parse\n  },\n  {\n    key: 'ssrTemplate',\n    fileName: 'index.ssr.html',\n    transform: parseTemplate\n  },\n  {\n    key: 'spaTemplate',\n    fileName: 'index.spa.html',\n    transform: parseTemplate\n  }\n]\n\n// Protector utility against request to SSR bundle files\nconst ssrResourceRegex = new RegExp(resourceMap.map(resource => resource.fileName).join('|'), 'i')\n","import Tapable from 'tappable'\nimport chalk from 'chalk'\nimport { Options } from 'common'\nimport ModuleContainer from './module'\nimport Renderer from './renderer'\nimport Debug from 'debug'\nimport enableDestroy from 'server-destroy'\nimport Module from 'module'\nimport { join, resolve } from 'path'\n\nconst debug = Debug('nuxt:')\ndebug.color = 5\n\nexport default class Nuxt extends Tapable {\n  constructor (_options = {}) {\n    super()\n\n    this.options = Options.from(_options)\n\n    // Paths for resolving requires from `rootDir`\n    this.nodeModulePaths = Module._nodeModulePaths(this.options.rootDir)\n\n    this.initialized = false\n    this.errorHandler = this.errorHandler.bind(this)\n\n    // Create instance of core components\n    this.moduleContainer = new ModuleContainer(this)\n    this.renderer = new Renderer(this)\n\n    // Backward compatibility\n    this.render = this.renderer.app\n    this.renderRoute = this.renderer.renderRoute.bind(this.renderer)\n    this.renderAndGetWindow = this.renderer.renderAndGetWindow.bind(this.renderer)\n\n    // Default Show Open if Nuxt is not listening\n    this.showOpen = () => {}\n\n    this._ready = this.ready().catch(this.errorHandler)\n  }\n\n  async ready () {\n    if (this._ready) {\n      return this._ready\n    }\n\n    await this.moduleContainer._ready()\n    await this.applyPluginsAsync('ready')\n    await this.renderer._ready()\n\n    this.initialized = true\n    return this\n  }\n\n  listen (port = 3000, host = 'localhost') {\n    // Update showOpen\n    this.showOpen = () => {\n      const _host = host === '0.0.0.0' ? 'localhost' : host\n      // eslint-disable-next-line no-console\n      console.log('\\n' + chalk.bgGreen.black(' OPEN ') + chalk.green(` http://${_host}:${port}\\n`))\n    }\n\n    return new Promise((resolve, reject) => {\n      const server = this.renderer.app.listen({ port, host, exclusive: false }, err => {\n        /* istanbul ignore if */\n        if (err) {\n          return reject(err)\n        }\n\n        // Close server on nuxt close\n        this.plugin('close', () => new Promise((resolve, reject) => {\n          // Destroy server by forcing every connection to be closed\n          server.destroy(err => {\n            debug('server closed')\n            /* istanbul ignore if */\n            if (err) {\n              return reject(err)\n            }\n            resolve()\n          })\n        }))\n\n        resolve(this.applyPluginsAsync('listen', { server, port, host }))\n      })\n\n      // Add server.destroy(cb) method\n      enableDestroy(server)\n    })\n  }\n\n  errorHandler /* istanbul ignore next */() {\n    // Apply plugins\n    // eslint-disable-next-line no-console\n    this.applyPluginsAsync('error', ...arguments).catch(console.error)\n\n    // Silent\n    if (this.options.errorHandler === false) {\n      return\n    }\n\n    // Custom errorHandler\n    if (typeof this.options.errorHandler === 'function') {\n      return this.options.errorHandler.apply(this, arguments)\n    }\n\n    // Default handler\n    // eslint-disable-next-line no-console\n    console.error(...arguments)\n  }\n\n  resolvePath (path) {\n    // Try to resolve using NPM resolve path first\n    try {\n      let resolvedPath = Module._resolveFilename(path, { paths: this.nodeModulePaths })\n      return resolvedPath\n    } catch (e) {\n      // Just continue\n    }\n    // Shorthand to resolve from project dirs\n    if (path.indexOf('@@') === 0 || path.indexOf('~~') === 0) {\n      return join(this.options.rootDir, path.substr(2))\n    } else if (path.indexOf('@') === 0 || path.indexOf('~') === 0) {\n      return join(this.options.srcDir, path.substr(1))\n    }\n    return resolve(this.options.srcDir, path)\n  }\n\n  async close (callback) {\n    await this.applyPluginsAsync('close')\n\n    /* istanbul ignore if */\n    if (typeof callback === 'function') {\n      await callback()\n    }\n  }\n}\n"],"names":["encodeHtml","str","replace","getContext","req","res","setAnsiColors","ansiHTML","setColors","ms","Promise","resolve","waitFor","urlJoin","slice","call","arguments","join","isUrl","url","indexOf","promisifyRoute","fn","Array","isArray","length","reject","err","routeParams","promise","then","sequence","tasks","reduce","task","parallel","all","map","chainFn","base","Function","apply","baseResult","undefined","fnResult","prototype","isPureObject","o","isWindows","test","process","platform","wp","p","wChunk","reqSep","sysSep","_","escapeRegExp","sep","normalize","string","r","args","lastArg","last","includes","relativeTo","dir","shift","path","rp","relative","flatRoutes","router","routes","forEach","children","push","cleanChildrenRoutes","isChild","start","routesIndex","route","name","split","s","names","paths","i","a","find","child","createRoutes","files","srcDir","file","keys","component","parent","key","chunkName","sort","b","y","z","_a","_b","Options","from","_options","options","Object","assign","loading","middleware","_routerBaseSpecified","transition","layoutTransition","defaultsDeep","defaults","hasValue","v","rootDir","cwd","modulesDir","buildDir","cacheDir","appTemplatePath","existsSync","dev","build","publicPath","store","loadingIndicator","cssSourceMap","postcss","postcssConfigExists","plugins","debug","modePreset","modes","mode","render","ssr","appear","env","NODE_ENV","__dirname","Debug","ModuleContainer","Tapable","nuxt","requiredModules","modules","addModule","bind","applyPluginsAsync","vendor","uniq","concat","template","src","srcPath","parse","fs","dst","fileName","basename","hash","ext","templateObj","templates","addTemplate","unshift","serverMiddleware","extend","extendRoutes","moduleOpts","requireOnce","originalSrc","module","require","resolvePath","Error","JSON","stringify","meta","alreadyRequired","result","MetaRenderer","renderer","vueRenderer","VueServerRenderer","createRenderer","cache","LRU","use","VueMeta","vm","Vue","h","head","renderToString","$meta","inject","get","m","getMeta","HTML_ATTRS","htmlAttrs","text","BODY_ATTRS","bodyAttrs","HEAD","title","link","style","script","noscript","resourceHints","clientManifest","resources","initial","async","set","color","jsdom","Renderer","bundleRenderer","metaRenderer","webpackDevMiddleware","webpackHotMiddleware","app","connect","parseTemplate","setupMiddleware","loadResources","_fs","distPath","updated","transform","rawKey","rawData","data","readFileSync","errorTemplatePath","errorTemplate","loadingHTMLPath","loadingHTML","noSSR","isReady","Boolean","spaTemplate","ssrTemplate","isResourcesAvailable","serverBundle","showOpen","createBundleRenderer","pify","$m","handler","prefix","$src","gzip","useMiddleware","compression","next","ssrResourceRegex","statusCode","end","_this","openInEditor","editor","configure","query","q","part","decodeURIComponent","log","open","catch","serveStatic","static","distDir","nuxtMiddleware","errorMiddleware","context","html","error","redirected","renderRoute","etag","generateETag","fresh","headers","setHeader","http2","regex","pushAssets","exec","rel","href","as","Buffer","byteLength","message","sendResponse","content","type","statusMessage","hasReqHeader","header","toLowerCase","isJson","json","youch","Youch","readSource","toJSON","toHTML","frame","sanitizeName","maps","$maps","smc","SourceMapConsumer","line","column","source","originalPositionFor","getLineNumber","getColumnNumber","lineNumber","columnNumber","functionName","contents","sourceContentFor","searchPath","pathDir","fullPath","readFile","isServer","spa","APP","messages","error_404","serverRendered","renderResourceHints","serialize","isJSON","renderScripts","renderStyles","opts","e","window","scrollTo","virtualConsole","VirtualConsole","sendTo","console","JSDOM","fromURL","nuxtExists","document","body","innerHTML","_onNuxtLoaded","templateStr","resourceMap","RegExp","resource","Nuxt","nodeModulePaths","Module","_nodeModulePaths","initialized","errorHandler","moduleContainer","renderAndGetWindow","_ready","ready","port","host","_host","chalk","bgGreen","black","green","server","listen","exclusive","plugin","destroy","resolvedPath","_resolveFilename","substr","callback"],"mappings":"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"}